# Firmware Offset Catalog

Addressing conventions: see `docs/CONVENTIONS.md`.

| File | Offset (hex) | Description | Evidence |
|------|--------------|-------------|----------|
| `ZK-INKJET-NANO-BOOT.bin` | `0X0` | Reset stub entering privileged modes and loading stack pointers for each CPU mode from literals at `0X40–0X54`. | `data/processed/boot_static_notes.md`, `docs/boot_analysis_methodology.md` |
| `ZK-INKJET-NANO-BOOT.bin` | `0X60` | Relocation helper that copies PC-relative vectors before branching to relocated entry (`bx r3`). | `data/processed/boot_static_notes.md`, `boot_disasm.txt` (methodology step 6) |
| `ZK-INKJET-NANO-BOOT.bin` | `0XF8` | Aligned memory copy routine (`memcpy`-style burst with residual handling). | `data/processed/boot_static_notes.md`, `boot_disasm.txt` (step 7) |
| `ZK-INKJET-NANO-BOOT.bin` | `0X210` | Unaligned memory copy variant using shifts to assemble words. | `data/processed/boot_static_notes.md` |
| `ZK-INKJET-NANO-BOOT.bin` | `0X348` | Division/modulo helper (`__aeabi_uidivmod` equivalent). | `data/processed/boot_static_notes.md` |
| `ZK-INKJET-NANO-BOOT.bin` | `0X52C` | Display command sequencer issuing T5L register writes (0X2A…0XE0). | `data/processed/boot_static_notes.md` |
| `ZK-INKJET-NANO-BOOT.bin` | `0X7C8` | Peripheral toggle: sets/clears bit 1 at `[base + 0X7C]` (likely watchdog/backlight). | `data/processed/boot_static_notes.md` |
| `VA 0X21282C (file+0X1282C)` | `VA 0X21282C (file+0X1282C)` | Format string for UI bitmap exports (`3:/inkjet-ui-%Y%m%d ... .bmp`). | `data/processed/app_strings_report.md` |
| `VA 0X25D130 (file+0X5D130)` | `VA 0X25D130 (file+0X5D130)` | Path reference to `0:/ZK-INKJET-RES-HW.zkml` (resource mount). | `data/processed/app_strings_report.md` |
| `VA 0X2688FC (file+0X688FC)` | `VA 0X2688FC (file+0X688FC)` | Reference to `3:/ZK-INKJET-NANO-BOOT.bin` (boot module load path). | `data/processed/app_strings_report.md` |
| `VA 0X3D3E00 (file+0X1D3E00)` | `VA 0X3D3E00 (file+0X1D3E00)` | Message handler table: `<handler_ptr, string_ptr, flag>` triples (12 bytes each). | `scripts/app_message_table.py` → `data/processed/app_message_table.json` |
| `ZK-INKJET-NANO-APP.bin` | `handler_ptr 0X2C2049 (Thumb) → VA 0X2C2048 (file+0XC2048)` | Flag 2 status handler; decrements queue depth (`[base+0X144]`), writes the active index to `[base+0X14C]`, and loads the current display slot from `[base+idx*8+0X164]`. | `objdump --start-address=0XC1F60` (file+0XC1F60), `docs/app_message_handlers.md` |
| `ZK-INKJET-NANO-APP.bin` | `handler_ptr 0X2C4525 (Thumb) → VA 0X2C4524 (file+0XC4524)` | USB error handler; performs 8/16-byte memmoves to slide queue records, updates `[base]`/`[base+4]`, then copies the new entry into the freed slot. | `objdump --start-address=0XC4500` (file+0XC4500), `docs/app_message_handlers.md` |
| `VA 0X66866667 (file+0X66666667)` | `handler_ptr 0X2C47F1 (Thumb) → VA 0X2C47F0 (file+0XC47F0)` | “Geen upgradebestand…” handler; compacts 0X14-byte records, recalculates the head pointer via `VA 0X66866667 (file+0X66666667)` multiply, and refreshes `[r7,#4]` with the next slot pointer. | `objdump --start-address=0XC47C0` (file+0XC47C0), `docs/app_message_handlers.md` |
| `ZK-INKJET-NANO-APP.bin` | `handler_ptr 0X2C28D1 (Thumb) → VA 0X2C28D0 (file+0XC28D0)` | Upgrade-found path; stages buffers through helpers at `0XC7018/0XC70F4/0XC7334`, then queues the notifier via `0XC61DC`. | `objdump --start-address=0XC2880` (file+0XC2880), `docs/app_message_handlers.md` |
| `VA 0X2C7018 (file+0XC7018)` | `VA 0X2C7018 (file+0XC7018)` | Part of bundled double-precision helper set (`__aeabi` style normalise/multiply) used by upgrade handler to compute glyph coordinates. | `objdump --start-address=0XC6FE0` (file+0XC6FE0), `docs/app_message_handlers.md` |
| `VA 0X28ACF0 (file+0X8ACF0)` | `VA 0X28ACF0 (file+0X8ACF0)` | Resource selection routine: scans pointer tables, runs `memcmp` (`0XE158`) against file names, and prepares bitmap buffers before notifier runs. | `objdump --start-address=0X8AC80` (file+0X8AC80), `docs/app_message_handlers.md` |
| `ZK-INKJET-NANO-APP.bin` | `handler_ptr handler_ptr 0X2C3A95 (Thumb) → VA 0X2C3A94 (file+0XC3A94) → file 0XC3A94` | Flag 3 error handler (Thumb); rotates queue indices and calls helper `0X29D34` before returning, used for “Openen mislukt…” strings. | `objdump --start-address=0XC3A80 -M force-thumb` (file+0XC3A80), `docs/app_message_handlers.md` |
| `VA 0X21138A (file+0X1138A)` | `VA 0X21138A (file+0X1138A)` | Queue initialiser for the upgrade free-block list; allocates a 0X20-byte node when `[queue_ctrl]` is null and writes the head pointer back to the controller. | `objdump -M force-thumb --adjust-vma=0X211380 /tmp/queue_init.bin`, `docs/analysis_traceability.md` §19 |
| `VA 0X2113E4 (file+0X113E4)` | `VA 0X2113E4 (file+0X113E4)` | Accessor that returns the queue controller pointer (literal resolves to VA ≈ `0X244F8C`). | `objdump -M force-thumb --adjust-vma=0X211380 /tmp/queue_init.bin`, `docs/analysis_traceability.md` §19 |
| `VA 0X211A88 (file+0X11A88)` | `VA 0X211A88 (file+0X11A88)` | Thumb routine that logs `\"direct: can't open\"` when SD/FAT access fails; wraps helper at `VA 0X211A1E (file+0X11A1E)`. | `objdump --start-address=0X11A80 -M force-thumb` (file+0X11A80), `docs/storage_probe_notes.md` |
| `VA 0X211AF8 (file+0X11AF8)` | `VA 0X211AF8 (file+0X11AF8)` | Heap allocator helper (calls `0XC798`, zeroes new blocks) used by storage stack before issuing SD commands. | `objdump --start-address=0X11AF0 -M force-thumb` (file+0X11AF0), `docs/storage_probe_notes.md` |
| `VA 0X411AFC (file+0X211AFC)` | `VA 0X411AFC (file+0X211AFC)` | Scratch-buffer allocator: reserves 0X88 bytes via `0X20C798`, clears the first byte, and hands the buffer back to the queue node. | `objdump -M force-thumb --adjust-vma=0X211AF0 /tmp/queue_alloc.bin`, `docs/analysis_traceability.md` §19 |
| `VA 0X4BFC34 (file+0X2BFC34)` | `VA 0X4BFC34 (file+0X2BFC34)` | Flash writer reached only when caller `0X2C1C10` sees a non-zero result from validator `0X2BFDDC` (cmp at `0X2C1C10`, call at `0X2C1C1C`). | `objdump --adjust-vma=0X2C1B80 /tmp/flash_guard.bin`, `docs/analysis_traceability.md` §27 |
| `VA 0X208592 (file+0X8592)` | `VA 0X208592 (file+0X8592)` | Candidate queue-vtable callback (resolved from literal at `VA 0X4113CC (file+0X2113CC)`; stored pointer is `0X208593`, i.e., Thumb address). Exact behaviour unknown pending relocation/RAM dump. | `objdump -M force-thumb --adjust-vma=0X208580 /tmp/vtable_target.bin`, `docs/analysis_traceability.md` §19 |
| `VA 0X444F8C (file+0X244F8C)` | `VA 0X444F8C (file+0X244F8C)` | Queue controller block (`file+0X44F8C`); first word stores the free-block head pointer returned by `0X2113E4`. | Thumb queue initialiser (`docs/analysis_traceability.md` §19) |
| `VA 0X4BFDDC (file+0X2BFDDC)` | `VA 0X4BFDDC (file+0X2BFDDC)` | Validator polled before flash writes; zero return skips the writer, non-zero lets caller `0X2C1C10` drop into `0X2BFC34`. | `objdump --adjust-vma=0X2C1B80 /tmp/flash_guard.bin`, `docs/analysis_traceability.md` §27, `docs/SESSION_HANDOFF.md` |
| `VA 0X269385 (file+0X69385)` | `queue_ctrl+0X8` | Controller slot patched at runtime with the default reader (`VA 0X269385 (file+0X69385)`, Thumb); invoked by `queue_prefill` whenever the one-shot override is empty. | `objdump -M force-thumb --adjust-vma=0X211356 /tmp/prefill.bin`, `objdump -M force-thumb --adjust-vma=0X269380 /tmp/default_prefill.bin`, `docs/SESSION_HANDOFF.md`, `docs/analysis_traceability.md` §26 |
| `ZK-INKJET-NANO-APP.bin` | `queue_ctrl+0X10` | One-shot prefill hook cleared during initialisation; writer still unknown and tracked in the open-issues list. | `objdump -M force-thumb --adjust-vma=0X211356 /tmp/prefill.bin`, `docs/SESSION_HANDOFF.md` |
| `VA 0X429C80 (file+0X229C80)` | `VA 0X429C80 (file+0X229C80)` | Reference-count helper for queue nodes; adjusts `[node+0X1C]` and returns the block to the allocator (`0X229D3C`) when the count drops to zero. | `objdump -M force-thumb --adjust-vma=0X229C80 /tmp/queue_work.bin`, `docs/analysis_traceability.md` §19 |
| `VA 0X429D78 (file+0X229D78)` | `VA 0X429D78 (file+0X229D78)` | Bulk work/flush routine that prepares blocks, invokes user callbacks, and calls `queue_dispatch()` (`0X211366`). | `objdump -M force-thumb --adjust-vma=0X229C80 /tmp/queue_work.bin`, `docs/analysis_traceability.md` §19 |
| `ZK-INKJET-NANO-APP.bin` | `0X217E820` | Literal table of upgrade filenames (`3:/ZK-INKJET-*.bin`); iterated by the filename matcher near `0X217DD0`. | `objdump --adjust-vma=0X217E820 /tmp/update_name_lit.bin`, `docs/update_file_rules.md` |
| `VA 0X45A930 (file+0X25A930)` | `VA 0X45A930 (file+0X25A930)` | memcmp loop over upgrade filename pool (`bl 0X20E158`); success drives upgrade-found path, failure falls toward `0XC47F0`. | `objdump --adjust-vma=0X25A900 /tmp/update_compare.bin`, `docs/update_file_rules.md` |
| `VA 0X45A990 (file+0X25A990)` | `VA 0X45A990 (file+0X25A990)` | Second memcmp loop (UI assets) referencing the same literal pool; same success/failure wiring as above. | `objdump --adjust-vma=0X25A900 /tmp/update_compare.bin`, `docs/update_file_rules.md` |
| `VA 0X45A9F0 (file+0X25A9F0)` | `VA 0X45A9F0 (file+0X25A9F0)` | Third memcmp loop (alternate UI package) tied into the upgrade-found / not-found handlers. | `objdump --adjust-vma=0X25A900 /tmp/update_compare.bin`, `docs/update_file_rules.md` |
| `VA 0X47B61C (file+0X27B61C)` | `VA 0X47B61C (file+0X27B61C)` | Filename classifier that lowercases the matched basename, checks the handler table, and selects the appropriate manifest builder. | `objdump --adjust-vma=0X27B61C /tmp/upgrade_classifier.bin`, `docs/analysis_traceability.md` §23 |
| `VA 0X47BB80 (file+0X27BB80)` | `VA 0X47BB80 (file+0X27BB80)` | Manifest builder enumerating per-component descriptors (offset/length/checksum slots) before queue dispatch. | `objdump --adjust-vma=0X27BB80 /tmp/manifest_builder.bin`, `docs/analysis_traceability.md` §23 |
| `VA 0X47BCC0 (file+0X27BCC0)` | `VA 0X47BCC0 (file+0X27BCC0)` | Callback installer writing reader/validator function pointers into the queue node. | `objdump --adjust-vma=0X27BCC0 /tmp/callback_installer.bin`, `docs/analysis_traceability.md` §23 |
| `VA 0X416B78 (file+0X216B78)` | `VA 0X416B78 (file+0X216B78)` | File I/O wrapper used by the queue worker and prospective RAM dump hook (open/write path). | traced via 0X25A930; candidate for dump_slice helper |
| `VA 0X415C64 (file+0X215C64)` | `VA 0X415C64 (file+0X215C64)` | Companion file wrapper (close/reset) used before queue dispatch and for dump finalisation. | traced via 0X25A930; candidate for dump_slice helper |
| `VA 0X20EA7A (file+0XEA7A)` | `VA 0X20EA7A (file+0XEA7A)` | Error stub: sets `r0=1`, calls the direct-open logger (`0X112F8`), and returns. | `objdump --start-address=0XEA70 -M force-thumb` (file+0XEA70), `docs/storage_probe_notes.md` |
| `VA 0X20EA5A (file+0XEA5A)` | `VA 0X20EA5A (file+0XEA5A)` | Wrapper that prepares stack state, calls the buffered transfer routine, and propagates success/failure. | `objdump --start-address=0XEA58 -M force-thumb` (file+0XEA58), `docs/storage_probe_notes.md` |
| `VA 0X20EA84 (file+0XEA84)` | `VA 0X20EA84 (file+0XEA84)` | Buffered transfer routine; loops over `0X11356` buffer lookups, falls back to the error stub when resolution fails. | `objdump --start-address=0XEA80 -M force-thumb` (file+0XEA80), `docs/storage_probe_notes.md` |
| `VA 0X20EAEC (file+0XEAEC)` | `VA 0X20EAEC (file+0XEAEC)` | Upgrade orchestrator; walks the free-block list rooted at `[0X44F8C]`, accumulates totals, bins block sizes by bit-width, calls `0X211B7C` for the average, then dispatches the two logging callbacks with the `%d bytes ...` / `blocks 2^%d+1...` strings. | `data/processed/upgrade_orchestrator_disasm.txt`, `docs/analysis_traceability.md` §18 |
| `VA 0X40EA5A (file+0X20EA5A)` | `VA 0X40EA5A (file+0X20EA5A)` | Chunk prefetch loop that reserves buffer windows and copies spans delivered by the queue read callback. | `objdump -M force-thumb --adjust-vma=0X20EA5A /tmp/chunk_prefetch.bin`, `docs/analysis_traceability.md` §24 |
| `VA 0X2A17C8 (file+0XA17C8)` | `VA 0X2A17C8 (file+0XA17C8)` | Orchestrator callback that rebuilds the `"RR aA"` status banner, serialises `[ctx+0X18]`/`[ctx+0X1C]` into ASCII at `[ctx+0X228..0X22F]`, and pushes the line via the T5L helpers `0X48610` / `0X48504`; leaves `[ctx+3]` asserted when DMA fails. | `docs/analysis_traceability.md` §18, `docs/app_message_handlers.md` |
| `VA 0X4302EC (file+0X2302EC)` | `VA 0X4302EC (file+0X2302EC)` | Shared notifier routine invoked by handlers; allocates 0X200-byte buffer, clears flags at `[#0X1660]`, enqueues work via `bl 0X22714C (file+0X2714C)` and other helpers for rendering. | `objdump --start-address=0X30200` (file+0X30200) |
| `VA 0X230E04 (file+0X30E04)` | `VA 0X230E04 (file+0X30E04)` | Hardware update routine writing to registers at base `0XB100D000` (via literal pool near `0X30F34`); configures colour/geometry and toggles bit 0 to latch updates. | `objdump --start-address=0X30E00` |
| `VA 0X411356 (file+0X211356)` | `VA 0X411356 (file+0X211356)` | Queue prefill bridge; calls the controller vtable to pull the next sector before `memcpy` into the staging buffer. | `objdump -M force-thumb --adjust-vma=0X211356 /tmp/queue_prefill.bin`, `docs/analysis_traceability.md` §24 |
| `VA 0X42C9E0 (file+0X22C9E0)` | `VA 0X42C9E0 (file+0X22C9E0)` | Flash geometry/prolog routine invoked before programming validated upgrade chunks. | `objdump --adjust-vma=0X22C9E0 /tmp/flash_probe.bin`, `docs/analysis_traceability.md` §25 |
| `VA 0X42CA18 (file+0X22CA18)` | `VA 0X42CA18 (file+0X22CA18)` | Page-program loop that calls the SD/flash driver (`0X2BC27C`, `0X2BFC34`) to commit the upgrade image (see guard at `0X2C1C10/0X2C1C1C`). | `objdump --adjust-vma=0X22CA18 /tmp/flash_program.bin`, `docs/analysis_traceability.md` §27 |
| `ZK-INKJET-RES-HW.zkml` | `file+0XA3000` | Candidate header/chunk zone (entropy ≈5.71, ASCII≈21%). | `data/processed/reshw_probe_report.md`, sample `reshw_05_0XA3000.bin` |
| `ZK-INKJET-RES-HW.zkml` | `file+0XB5000` | Candidate chunk region (similar statistics). | `data/processed/reshw_probe_report.md`, sample `reshw_04_0XB5000.bin` |
| `ZK-INKJET-RES-HW.zkml` | `file+0XD7000` | Candidate chunk region (investigate for TOC entries). | `data/processed/reshw_probe_report.md`, sample `reshw_03_0XD7000.bin` |
| `ZK-INKJET-RES-HW.zkml` | `file+0XEB000` | Candidate chunk region (aligned, medium entropy). | `data/processed/reshw_probe_report.md`, sample `reshw_02_0XEB000.bin` |
| `ZK-INKJET-RES-HW.zkml` | `file+0X10A000` | Candidate chunk region (top-ranked by probe). | `data/processed/reshw_probe_report.md`, sample `reshw_01_0X10A000.bin` |
| `ZK-INKJET-RES-HW.zkml` | `file+0X164000` | Candidate chunk region near end of file. | `data/processed/reshw_probe_report.md`, sample `reshw_06_0X164000.bin` |

_Add further offsets as soon as disassembly or probing reveals new actionable locations._
